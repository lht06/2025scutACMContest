\problemWithTimeMem{城市供电网络}{8 seconds}{1024MB}

某城市的供电网络由 $n$ 个变电站（节点）和 $n-1$ 条电缆（边）构成一棵树。每个节点有一个实时负载值 $w$。当关闭某个变电站时，网络会分裂成若干个联通块。为了评估风险，需要计算以下内容：

\textbf{区域瓶颈}：每个联通块的负载最小值（即该联通块中所有节点的最小负载）。

\textbf{风险等级}：所有区域瓶颈的最小未出现值（mex），即最小的非负整数，未在这些区域瓶颈中出现。

你需要处理以下两种动态操作：

1.\textbf{修改负载}：将某个节点的负载值更新为新值。

2.\textbf{模拟关闭}：假设关闭某个节点，计算分裂后的风险等级。

\mysec{Input}

第一行输入一个整数 $n$，表示节点数。($2 \leqslant n \leqslant 10^6$)

第二行输入 $n$ 个整数 $w_1,w_2, \cdots , w_n$，表示每个节点的初始负载值。（$0\leqslant w_i\leqslant 10^9$）

接下来 $n-1$ 行：每行两个整数 $u$ 和 $v$，表示一条连接节点 $u$ 和 $v$ 的电缆。($1\leqslant u,v \leqslant n$)

接下来一行输入一个整数$q$，表示操作数。($1 \leqslant q \leqslant 10^6$)

接下来 $q$ 行：每行表示一个操作：

修改负载操作：\verb|1 x v|，将节点 $x$ 的负载值改为 $v$。（$1\leqslant x \leqslant n,0\leqslant v \leqslant 10^9$）

模拟关闭操作：\verb|2 x|，假设关闭节点 $x$，输出风险等级。($1\leqslant x \leqslant n$)

\mysec{Output}

对于每个模拟关闭操作\verb|2 x|，输出一行一个整数，表示风险等级。

数据保证至少有一个模拟关闭操作。

\ACMIO{Sample 1}{%
6

4 6 0 6 5 1

5 4

6 5

3 1

5 3

2 1

5

2 3

1 5 3

2 1

1 2 1

2 1
}{%
0

1

2
}
